---
import { isLinkMissing, normalizeLink } from "../lib/doc-link";

interface Props {
  src: string;
  section?: string;
}

const { src, section } = Astro.props;

const missing = await isLinkMissing(src);
const link = normalizeLink(src) + (section ? "#" + section : "");
---

{
  missing ? (
    <span class="doc-link missing" title={`${src} (missing)`}>
      <slot />
    </span>
  ) : (
    <a class="doc-link" href={link} title={src}>
      <slot />
    </a>
  )
}

<style>
  .doc-link.missing {
    color: var(--cppdoc-color-missing-link);
  }
</style>
